define(["jquery","bootstrap_typeahead"],function(e,t){var n=function(e,t){this.init(e,t)};return n.prototype=e.extend({},t.prototype,{constructor:n,defaults:e.extend({},e.fn.typeahead.defaults,{menuId:"lpp-search-results",prefix:"Postajališče: "}),init:function(n,r){var i=this;r=e.extend(i.defaults,r),t.apply(i,[n,r]),i.$content=e("#lpp-content"),i.$menu.attr("id",this.options.menuId),i.$element.on("focus",function(t){var n=i.options.prefix;e(this).val().substr(0,n.length)===n&&e(this).val(e(this).val().substr(n.length))})},toItemsWithNames:function(t){var n=[];return e.each(t,function(e,t){n.push(t.name)}),n},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(e)},select:function(t){var n=this.$menu.find(".active").attr("data-value");return n?this.showContent(n):(n=e(t.target).parents("[data-value]").data("value"),this.showContent(n,e(t.target).html())),this.$element.val(this.updater(n)).change(),this.hide()},show:function(){return this.$content.hide(),t.prototype.show.call(this)},updater:function(e){return this.options.prefix+e},matcher:function(e){return t.prototype.matcher.apply(this,[e.name])},sorter:function(n){var r=this,i=[];return n=this.toItemsWithNames(n),e.each(t.prototype.sorter.apply(this,[n]),function(e,t){i.push(r.options.stations_by_name[t])}),i},render:function(n){var r=this,i;return n=r.toItemsWithNames(n),t.prototype.render.apply(r,[n]),r.options.stations_by_name&&r.$menu.children().each(function(t,n){i=e("<ul>").appendTo(n),e.each(r.options.stations_by_name[e(n).data("value")].routes,function(t,n){i.append(e("<li/>").addClass("lpp-route-"+n).append(e('<a href="#"/>').html(n)))})}),r},showContent:function(t,n){var r=this;$progresbar=e('<div class="progress progress-striped active"> <div class="bar" style="width: 100%;"></div></div>'),$closebtn=e('<a href="#" class="lpp-close-btn">Zapri</a>'),$title=e("<h2>Prihodi avtobusov:</h2>"),r.$content.html(""),$closebtn.appendTo(r.$content).on("click",function(e){e.stopPropagation(),e.preventDefault(),r.$content.hide()}),r.$content.css("min-height",e(window).height()-100),$progresbar.appendTo(r.$content).css("margin-top",r.$content.height()/2-$progresbar.outerHeight()/2),r.$content.show(),setTimeout(function(){var i={};e.each(r.options.stations_by_name[t].routes,function(e,t){i[t]={},i[t]["Direction 1"]=[7,12,20,30,45],i[t]["Direction 2"]=[7,20,45,55]}),$progresbar.remove(),$title.appendTo(r.$content);var s=e("<ul/>").appendTo(r.$content),o;e.each(i,function(t,r){if(!n||n===t)o=e("<li/>").append('<a class="lpp-route-'+t+'" href="#">'+t+"</a>").appendTo(s),e.each(r,function(t,n){e('<div class="lpp-arrival-times"> <h3>'+t+"</h3>"+" <p>"+n.join("', ")+"'</p>"+"</div>").appendTo(o)}),e('<div style="clear:both;"></div>').appendTo(o)})},1e3)}}),n});